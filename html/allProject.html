<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>考试报名系统</title>
    <link rel="stylesheet" type="text/css" href="../css/login.css">
    <link rel="stylesheet" href="../layui-v2.5.6/layui/css/layui.css">
    <link rel="stylesheet" href="../css/allProject.css">
</head>
<body>
    <!-- 导航栏 -->
    <div class="top">
        <ul class="layui-nav">
            <a href="login.html"><img src="../img/LOGO.png" alt="" class="navlogo"></a>
            <li class="layui-nav-item">
                <a href="login.html" class="">首页</a>
            </li>
            <li class="layui-nav-item">
                <a href="login.html" class="">考试资讯</a>
            </li>
            <li class="layui-nav-item">
                <a href="personal.html" class=" ">个人中心</a>
            </li>
            <li class="layui-nav-item login-homePage hide" id="loginD">
                <a href="signIn.html" class="">登录</a>
            </li>
            <li class="layui-nav-item  hide" id="loginZ">
                <a href="register.html" class="login-homePageA">注册</a>
            </li>
            <li class="layui-nav-item exitA  hide">
                <a href="javascript:;" class="login-homePageC"></a>
            </li>
            <li class="layui-nav-item login-homePageB hide">
                <a href="javascript:;" class="myname layui-nav-img"></a>
            </li>
            
        </ul>
        <form class="layui-form div-bor navigationB" action="">
            <!-- <div class="layui-form-item"> -->
            <a href="allProject.html"><i class="iconfontA"><img src="../img/route1.png" alt=""></i></a>
            <input type="text" name="title" lay-verify="title" autocomplete="off" placeholder=""
                class="layui-input" value="英语">
            <!-- </div> -->
        </form>
    </div>
    <!-- 身体 -->
    <div class="hd body-allProject">
        <!-- 所有比赛  -->
        <div class="hd-test">
            <span>所有比赛</span>
            <!-- <span><a href="#">全部</a></span> -->
        </div>
        <div class="hd-mainA">
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
            <div class="testModular">
                <a href="detailsPage.html">
                    <img alt="" class="allProjectImg">
                    <div class="pullUpA">
                        <p class="pullUppA allProjectTopA"></p>
                        <div class="loginbox">
                            <span class="loginPrice">￥68.00</span>
                            <i class="logini"><img src="../img/route2.png" alt="">123</i>
                        </div>
                    </div>
                </a>
            </div>
        </div>
        <div id="demo1"></div>
    </div>
    <!-- 底部 -->
    <div class="ft">
        <div class="ftA">
            <ul class="firstUl">
                <li class="firstLi">OERP 在线考试报名平台</li>
                <li class="secondLi">OERP 是一个专为考生服务的考试报名平台 旨在为考生提供一站式的报名服务</li>
                <li>©2020 OERP&nbsp;&nbsp;&nbsp;&nbsp;渝ICP备18000683号-3</li>
            </ul>
            <ul class="secondUl">
                <li class="thirdLi">友情链接</li>
                <li><a href="http://www.neea.edu.cn/">中国考试教育网</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cpta.com.cn/">中国人事考试网</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.offcn.com/">中公教育</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://developer.aliyun.com/">开发者社区</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.xdf.cn/">新东方网</a></li>
                <li><a href="https://edu.sina.com.cn/">新浪教育</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.exam8.com/">考试吧</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://juzibiji.top/">桔子笔记</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://www.51test.net/">无忧考</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://www.naixuejiaoyu.com/">奈学教育</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://class.hujiang.com/">沪江网校</a></li>
            </ul>
        </div>
    </div>
<script src="../layui-v2.5.6/layui/layui.js"></script>
    <script src="../js/jquery-1.12.4.js"></script>
    <script src="../js/myAjax.js"></script>
    <script>
        //
        // $(".layui-laypage").children("span").css("margin","5px")
        // 导航栏
        layui.use('element', function () {
            var element = layui.element; //导航的hover效果、二级菜单等功能，需要依赖element模块

            //监听导航点击
            element.on('nav(demo)', function (elem) {
                //console.log(elem)
                layer.msg(elem.text());
            });
        });

        // Tab
        layui.use('element', function () {
            var $ = layui.jquery,
                element = layui.element;
        });
        // //导航栏-登录
        $(function () {
            $("#loginD").on("click", function () {
                $("#loginInterfaceCenter").stop().fadeIn(300);
                $("#bg").stop().fadeIn(300);
            });
            $("#iconFirst").on("click", function () {
                $("#loginInterfaceCenter").stop().fadeOut(300);
                $("#bg").stop().fadeOut(300);
            });
            //导航栏--注册
            //导航栏--注册--1
            $("#loginZ").on("click", function () {
                $("#registrationPanel").stop().fadeIn(300);
                $("#bg").stop().fadeIn(300);
            });
            $("#iconSecond").on("click", function () {
                $("#registrationPanel").stop().fadeOut(300);
                $("#bg").stop().fadeOut(300);
            });
            //导航栏--注册--2
            $("#iconThird").on("click", function () {
                $("#registrationPanelA").stop().fadeOut(300);
                $("#bg").stop().fadeOut(300);
            });
            //导航栏--注册--3
            $("#nextBb").on("click", function () {

                $(".exitA").removeClass("hide");
                $(".successA").removeClass("hide");
                $("#loginD").addClass("hide");
                $("#loginZ").addClass("hide");
            });
            $("#iconFourth").on("click", function () {
                $("#registrationPanelB").stop().fadeOut(300);
                $("#bg").stop().fadeOut(300);
                $(".exitA").removeClass("hide");
                $(".successA").removeClass("hide");
                $("#loginD").addClass("hide");
                $("#loginZ").addClass("hide");
            });
        });

        
        //搜索框查询
        $(".div-bor .iconfontA").on("click", function () {
            localStorage.setItem("keyword", $(".layui-input").val());
        });


        // 登录过一次以后，刷新页面后自动登录

        if (localStorage.getItem("token")) {
            var token = localStorage.getItem("token");
            $.ajax({
                url: 'https://oerp.juzibiji.top/api/v1/user',
                headers: {
                    Authorization: localStorage.getItem("token")
                },
                type: 'get',
                contentType: 'application/x-www-form-urlencoded',
                success: function (data, status) {
                    $(".myname").css("backgroundImage",`url(${data.data.avatarUrl})`)
                    $(".exitA").removeClass("hide");
                    $(".login-homePageB").removeClass("hide");
                    
                },
                error: function (e) {
                    console.log(e)

                    console.log("系统错误，请稍后再试")
                }
            });
        }else{
            $("#loginD").removeClass("hide");
            $("#loginZ").removeClass("hide");
        }

        // 进入页面自动显示所有考试
        myAjax('https://oerp.juzibiji.top/api/v1/user/exam', 'get', 'true', 'application/x-www-form-urlencoded', ({
                pageOn: 1,
                pageSize: 20,
                keyword: localStorage.getItem("keyword")
            }),
            function (data, status) {
                for (let i = 0; i < 20; i++) {
                    $(".allProjectImg")[i].src = data.data.records[i].imageUrl;
                    $(".allProjectImg").siblings("div").children("p")[i].innerText = data.data.records[i].title;
                    $(".loginPrice")[i].innerText = "￥" + data
                        .data.records[i].price;
                    // 点击了解详情获取考试id并存入localStorage中
                    $(".testModular")[i].onclick = function () {
                        localStorage.setItem("id","");
                        localStorage.setItem("id",data.data.records[i].id);
                    };
                }
                //分页
                layui.use(['laypage', 'layer'], function () {
                    var laypage = layui.laypage,
                        layer = layui.layer;
                    //总页数大于页码总数
                    laypage.render({
                        elem: 'demo1',
                        count: data.data.total, //数据总数
                        limit: 20,
                        jump: function (obj) {
                            console.log(obj)
                            myAjax('https://oerp.juzibiji.top/api/v1/user/exam', 'get', 'true',
                                'application/x-www-form-urlencoded', ({
                                    pageOn: obj.curr,
                                    pageSize: 20,
                                    keyword: localStorage.getItem("keyword")
                                }),
                                function (data, status) {
                                    for (let i = 0; i < 20; i++) {
                                        $(".allProjectImg")[i].src = data.data.records[i].imageUrl;
                                        $(".allProjectImg").siblings("div").children("p")[i].innerText = data.data.records[i].title;
                                        $(".loginPrice")[i].innerText = "￥" + data.data.records[i].price;
                                    }
                                    localStorage.setItem("total", data.data.total);
                                    
                                }
                            );
                        }
                    });

                    laypage.render({
                        elem: 'demo20',
                        count: data.length,
                        jump: function (obj) {
                            //模拟渲染
                            document.getElementById('biuuu_city_list').innerHTML = function () {
                                var arr = [],
                                    thisData = data.concat().splice(obj.curr * obj.limit -
                                        obj.limit,
                                        obj.limit);
                                layui.each(thisData, function (index, item) {
                                    arr.push('<li>' + item + '</li>');
                                });
                                return arr.join('');
                            }();
                        }
                    });
                });
            }
        );

        // 登录过一次以后，刷新页面后自动登录

        if (localStorage.getItem("token")) {
            var token = localStorage.getItem("token");
            $.ajax({
                url: 'https://oerp.juzibiji.top/api/v1/user',
                headers: {
                    Authorization: localStorage.getItem("token")
                },
                type: 'get',
                contentType: 'application/x-www-form-urlencoded',
                success: function (data, status) {
                    $(".myname").css("backgroundImage",`url(${data.data.avatarUrl})`)
                    $(".exitA").removeClass("hide");
                    $(".login-homePageB").removeClass("hide");
                    
                },
                error: function (e) {
                    console.log(e)

                    console.log("系统错误，请稍后再试")
                }
            });
        }else{
            $("#loginD").removeClass("hide");
            $("#loginZ").removeClass("hide");
        }
    </script>
</body>

</html>